package main

import (
	"github.com/intdxdt/geom"
	"simplex/ctx"
	"simplex/homotopy"
	"fmt"
)

func loads(wkt string) []*geom.Point {
	return geom.NewLineStringFromWKT(wkt).Coordinates()
}

func main() {
	//var wkt = "LINESTRING ( 800 1087.5, 800 1143.75, 875 1143.75, 875 1087.5, 837.5 1087.5, 837.5 1118.75, 850 1118.75, 850 1100, 862.5 1100, 862.5 1131.25, 825 1131.25, 806.25 1106.25, 825 1075, 887.5 1075, 887.5 1125 )"
	//var wkt = "LINESTRING ( 800 1087.5, 800 1143.75, 875 1143.75, 875 1081.25, 825 1081.25, 825 1125, 862.5 1125, 862.5 1106.25, 856.25 1100, 850 1100, 850 1118.75, 837.5 1112.5, 837.5 1093.75, 868.75 1093.75, 868.75 1137.5, 818.75 1137.5, 806.25 1106.25, 818.75 1075, 887.5 1075, 887.5 1125 )"
	//var wkt = "LINESTRING ( 800 1087.5, 800 1131.25, 875 1131.25, 875 1100, 862.5 1100, 862.5 1118.75, 850 1125, 850 1087.5, 831.25 1093.75, 831.25 1112.5, 812.5 1118.75, 812.5 1081.25, 887.5 1081.25, 887.5 1125 )"
	//var wkt = "LINESTRING ( 750 1025, 750 1000, 856.25 1000, 856.25 1037.5, 837.5 1037.5, 837.5 1012.5, 806.25 1012.5, 806.25 1043.75, 818.75 1043.75, 825 1031.25, 793.75 1031.25, 793.75 1012.5, 781.25 1012.5, 775 1031.25, 762.5 1037.5, 762.5 1050, 875 1050, 875 1025 )"
	//var wkt = "LINESTRING ( 743.75 1025, 743.75 1000, 862.5 1000, 862.5 1037.5, 850 1037.5, 850 1006.25, 793.75 1006.25, 793.75 1043.75, 837.5 1043.75, 837.5 1012.5, 812.5 1012.5, 812.5 1037.5, 775 1037.5, 775 1012.5, 756.25 1012.5, 756.25 1050, 875 1050, 875 1025 )"
	//var wkt = "LINESTRING ( 743.75 1025, 743.75 1000, 862.5 1000, 862.5 1037.5, 850 1037.5, 850 1006.25, 793.75 1006.25, 793.75 1043.75, 837.5 1043.75, 837.5 1012.5, 812.5 1012.5, 812.5 1037.5, 775 1037.5, 775 1012.5, 756.25 1012.5, 756.25 1050, 875 1050, 875 1025 )"
	//var wkt = "LINESTRING ( 743.75 1025, 743.75 1000, 862.5 1000, 862.5 1037.5, 850 1037.5, 850 1006.25, 793.75 1006.25, 793.75 1037.5, 812.5 1037.5, 812.5 1012.5, 831.25 1012.5, 831.25 1043.75, 775 1043.75, 775 1012.5, 756.25 1012.5, 756.25 1050, 875 1050, 875 1025 )"
	//var wkt = "LINESTRING ( 743.75 1025, 743.75 1000, 837.6016576565926 1000, 837.5 1037.5, 818.75 1037.5, 818.75 1012.5, 781.25 1012.5, 781.25 1037.5, 800.2705122488694 1043.75, 800 1006.25, 756.25 1006.25, 756.25 1050, 850 1050, 850 1025 )"
	//var wkt = "LINESTRING ( 743.75 943.75, 743.75 968.75, 831.25 968.75, 831.25 931.25, 762.5 931.25, 762.5 956.25, 775 956.25, 775 937.5, 787.5 937.5, 787.5 956.25, 800 956.25, 800 937.5, 825 937.5, 825 962.5, 806.25 962.5, 806.25 950, 818.75 950, 818.75 943.75, 812.5 943.75 )"
	//var wkt = "LINESTRING ( 743.75 943.75, 743.75 968.75, 831.25 968.75, 831.25 925, 762.5 925, 762.5 956.25, 775 956.25, 775 931.25, 825 931.25, 825 962.5, 787.5 962.5, 787.5 937.5, 800 937.5, 800 956.25, 818.75 956.25, 818.75 950, 812.5 943.75 )"
	//var wkt = "LINESTRING ( 743.75 1025, 743.75 1006.25, 806.25 1006.25, 806.25 1037.5, 793.75 1037.5, 793.75 1012.5, 781.25 1012.5, 781.25 1037.5, 768.75 1037.5, 768.75 1012.5, 756.25 1012.5, 756.25 1043.75, 818.75 1043.75, 819.0695013203165 1025 )"
	//var wkt = "LINESTRING ( 743.75 1025, 743.75 1006.25, 806.25 1006.25, 806.25 1037.5, 793.75 1037.5, 793.75 1012.5, 781.25 1012.5, 781.25 1037.5, 768.75 1037.5, 768.75 1012.5, 756.25 1012.5, 756.25 1043.75, 818.75 1043.75, 819.0695013203165 1025 )"
	var wkt = "LINESTRING ( 743.75 1025, 743.75 1006.25, 806.25 1006.25, 806.25 1037.5, 793.75 1037.5, 793.75 1012.5, 781.25 1012.5, 781.25 1037.5, 768.75 1037.5, 768.75 1012.5, 756.25 1012.5, 756.25 1043.75, 818.75 1043.75, 819.0695013203165 1025 )"
	//var cwkt = "POLYGON (( 851.8796625631664 1090.996269949467, 851.8796625631664 1097.246269949467, 858.1296625631664 1097.246269949467, 858.1296625631664 1090.996269949467, 851.8796625631664 1090.996269949467 ))"
	//var cwkt = "POLYGON (( 853.4156432810616 1102.3625272618917, 853.4156432810616 1108.6125272618917, 859.6656432810616 1108.6125272618917, 859.6656432810616 1102.3625272618917, 853.4156432810616 1102.3625272618917 ))"
	//var cwkt = "POLYGON (( 843.75 1118.75, 843.75 1125, 850 1125, 850 1118.75, 843.75 1118.75 ))"
	//var cwkt = "POLYGON (( 818.75 1106.25, 818.75 1112.5, 825 1112.5, 825 1106.25, 818.75 1106.25 ))"
	//var cwkt = "POLYGON (( 806.25 1031.25, 806.25 1037.5, 812.5 1037.5, 812.5 1031.25, 806.25 1031.25 ))"
	var cwkt = []string {
		"POLYGON (( 784.7920254078326 1017.440233182224, 784.7920254078326 1021.6584329771414, 789.6351436908859 1021.6584329771414, 789.6351436908859 1017.440233182224, 784.7920254078326 1017.440233182224 ))",
		"POLYGON (( 753.4303829642345 1022.2740228863009, 753.4303829642345 1027.776022618802, 759.5437160003468 1027.776022618802, 759.5437160003468 1022.2740228863009, 753.4303829642345 1022.2740228863009 ))",

	}
	var contexts = ctx.NewContexts()
	for _, o := range cwkt {
		contexts.Push(ctx.New(geom.ReadGeometry(o), 0, -1) )
	}
	var coords = loads(wkt)
	var p = geom.NewPolygon(coords)
	fmt.Println(p.WKT())
	var bln = homotopy.Homotopy(coords, contexts)
	fmt.Println(bln)
}
